# Story: v0.1.0 Hello World Solana 程序

> 实现一个基础的 Hello World Solana 程序，验证 Zig-Solana 架构的可行性

## 目标

实现一个最简单的 Solana 程序：
1. 当程序被调用时，输出 "Hello Roc on Solana!" 日志
2. 程序能够编译为 Solana BPF 格式
3. 程序能够部署到本地测试网
4. 程序能够被成功调用

## 验收标准

### platform/main.roc
- [x] 定义 Roc 平台接口
- [x] 导出 main_for_host 函数给 Zig 宿主调用
- [x] 支持基本的字符串返回

### src/host.zig
- [x] 实现 Roc 分配器接口 (roc_alloc, roc_dealloc, roc_realloc)
- [x] 实现 roc_panic 处理
- [x] 实现 Solana 入口点 (entrypoint)
- [x] 使用 solana-program-sdk-zig 的 allocator 和 log 模块
- [x] 调用 sol_log 输出日志

### examples/hello-world/app.roc
- [x] 使用 Solana 平台
- [x] 返回 "Hello from Roc on Solana!" 字符串

### build.zig
- [x] 配置 BPF 目标编译
- [x] 使用 solana-program-sdk-zig 的构建模式
- [x] 集成 sbpf-linker 链接步骤
- [x] 生成可部署的 .so 文件

### 测试和部署
- [x] Zig 构建成功 (zig build test)
- [x] 生成有效的 BPF 字节码 (zig build solana)
- [x] 部署到本地测试网成功
- [x] 调用程序并验证日志输出 ✅ "Hello Roc on Solana!"

### 文档
- [x] 更新 README.md 包含使用说明
- [x] 创建部署脚本 (scripts/deploy.sh)
- [x] 创建调用脚本 (scripts/invoke.sh)

## 技术方案

### 编译流程

```
Zig 宿主代码 (host.zig)
    ↓ zig build solana
LLVM 位码 (.bc)
    ↓ sbpf-linker
Solana eBPF (.so)
    ↓ solana program deploy
部署成功
```

### 架构

```
┌─────────────────────────────────────┐
│         src/host.zig                │ ← Zig 宿主 + Roc 运行时接口
│   entrypoint → sol_log              │
└─────────────────────────────────────┘
                 ↓
┌─────────────────────────────────────┐
│    vendor/solana-program-sdk-zig    │ ← Solana SDK
│   (allocator, log, syscalls)        │
└─────────────────────────────────────┘
```

## 测试结果

```
Program 7it5kQTZSLyvMuiZuWWiyuGqh3k4jnPnSwZC5dg4Xkif invoke [1]
Program log: Hello Roc on Solana!
Program 7it5kQTZSLyvMuiZuWWiyuGqh3k4jnPnSwZC5dg4Xkif consumed 105 of 200000 compute units
Program 7it5kQTZSLyvMuiZuWWiyuGqh3k4jnPnSwZC5dg4Xkif success
```

## 完成状态

- 开始日期: 2026-01-03
- 完成日期: 2026-01-03
- 状态: ✅ 已完成

## 下一步

- [ ] v0.2.0: 集成真正的 Roc 编译器输出
- [ ] 实现 Roc → LLVM BC 编译流程
- [ ] 支持 Roc 效果系统映射到 Solana syscalls
